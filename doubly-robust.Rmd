
```{r}
set.seed(0)
```

```{r}
n = 1000

# GENERATE IVs
one = rep(1, n) # For propensity score calculations, below
z1 <- rnorm(n, mean = 0, sd = 1)
z2 <- rnorm(n, mean = 0, sd = 1)
z3 <- replicate(n, ifelse(rnorm(1, mean = 0, sd = 1) <= 0.3, 1, 0))

# GENERATE EXPOSURE AS A FUNCTION OF IVs

# Set betas
b0 = 1.5
b1 = 1
b2 = -2
b3 = 1

# Calculate propensity scores
ps <- (1 + exp(b0*one + b1*z1 + b2*z2 + b3*z3))^(-1)

# Calculate exposure
x <- ifelse(ps + runif(n, min = 0, max = 1) < 0.91, 1, 0)

# GENERATE OUTCOMES
b4 <- 2
z4 <- rnorm(n, mean = 0, sd = 1)
y <- b1*z1 + b3*z3 + b4*z4
```



